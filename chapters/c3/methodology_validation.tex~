\section{Methodology Validation}

In the last chapter, the analytical survival probability $S(\tau)$ has
been derivative and approximated by the numerical method. In the
annulus image as shown in Figure $1.1$, Lattice Random Walks (LRWs)
and Pearson's Random Walks (PRWs) are implemented in Python. The main
objective of this chapter is to validate whether the estimated
survival function $S(t)$ converges to $S(\tau)$.

\subsection{Statistical Fluctuation Analysis}

Fixed-time step Monte Carlo simulation is a virtually representation
of the original continious-time statistical problem with numerous
inputs and discrete-time trajectories sampled randomly over and over again,
which results in the the statistical fluctuation. Thus, the Monte Carlo
technquies will not be exact but have an associated error band.

Let $t$ be the number of steps taken by a particle from the starting
site to the stop site in the discrete-time simulations. As shown in
Figure $2.1$, the larger the number of particles $N$ in the
simulation, the more precise will be the estimated survival
functions. One the downside, the increasing number of trials results
in the higher cost of performing the simulation, which is the major
drawback of the Fixed time-step Monte Carlo simulation. Therefore, it
is necessary to conduct the minimum number of simulation runs to
achieve a desired degree of precision.

The average one-step displacement $\triangle l$ of particles in the
simulations are accoaiated with the time step is $\delta$, which can
be expressed by

\begin{equation}
  \triangle l = 2 \sqrt{D \delta}
\end{equation}
where the diffusion coefficent $D$ is 1.

The time step $\delta$ must be designed small enough to make sure that
$\triangle l$ is smaller than the smallest geometrical features of the
boundaries in the image. Thus, in LRWs and PRWs, $\triangle l$ should
equal or be less than one pixel size. Moreover, the $\delta$ is
regarded as a fundamental bridge between $t$ and unitless continius
time $\tau$,

\begin{equation}
 \tau = t \times \delta
\end{equation}

\begin{figure}[h!]
  \centering
  \subfloat{\includegraphics[width=\textwidth]{sampling}}%
  \caption{As the number of particles increasing, the uncertainty of
    the LRWs simulation are lower since the confidence band of the
    estimated survival function becomes narrower.}
\end{figure}


\subsection{Sample Size Determination}

The sample size in the random walks model can be determiend by the
inferential statistics, which estimates the unknown population
parameters from the sample statstics. Based on the law of large
numbers (LLN), as the sample size approaches infinity, the sample mean
tends to get closer to the true population mean with the high
probability. Moreover, the central limit theorem illustrates how the
sampling distribution of the mean changes as a function of the sample
size and how much more reliable a large experiment is.

\begin{figure}[h!]
  \centering
  \subfloat[]{\includegraphics[width=0.5\textwidth]{kde}}%
  %\qquad
  \subfloat[]{\includegraphics[width=0.5\textwidth]{linear_regression}}%
  \caption{(a) Runing the LRWs with $N = 2^i$ particles and
    calculating the mean first-passage time $X_N$, where $i=3, 4, 5,
    ..., 12$. For each $N$, replicating the simulation $50$ times and
    recalculating the mean of the mean first-passage time $\bar X_{N}$
    and the variance $\sigma^2_{N}$. As the sample size $N$ increase,
    the distribution of the sample means $X_N$ becomes narrower and
    approximately normal. (b) A fitted linear regression model is used to
    explore the relationship between $log_{2} (\sigma^2_{N})$ and
    $log_{2} N$. $log_{2} (\sigma^2_{N}) \approx b + k log_{2} N$,
    where $k$ and $b$ are the estimated model parameters, slope and
    intercept, respectively.}
\end{figure}

According to LLN, the unknown population mean first-passage time
$\barX$ can be estimated by sample mean $\bar X_N$ when $N$ is big
enough. Chebyshev’s inequality is a probabilistic inequality that can
be applied to any probability distribution of a random variable with
the finite expected value and non-zero variance. This inequality
provides an upper bound to the probability that the absolute deviation
of a random variable from its mean will exceed a given
threshold. Given a predesignated error $\epsilon$, the required number
of particles $N$ can be determined by

\begin{equation}
  Pr(|X_{N} - \bar X| \geq \epsilon) = Pr(|X_{N} - \bar X_{N}| \geq
  \epsilon) \leq \frac{\sigma^2_{N}}{\epsilon^2} \approx \frac{2^b
    N^k}{\epsilon^2} = 0.01
\end{equation}

where $\epsilon = 0.01 \bar X$.

\newpage

\subsection{Convergence Evaluation}

The required number of particles in the numerical experiment can be estimated by Eq.(2.3), which is

\begin{equation}
  N \geq (\frac{0.01 \epsilon^2}{2^b})^{\frac{1}{k}} \approx 1338643
\end{equation}

where $\epsilon \approx 189.80$, $b \approx 28.49$, and $k \approx -0.98$. 

Therefore, the sample should be at least $1338643$ to make sure that
there is no more than $1\%$ chance of $X_N$ to be outside
$[0.46865856, 0.47812641]$.

\begin{figure}[h!]
  \centering
  \subfloat[]{\includegraphics[width=0.5\textwidth]{LRWs_analytical}}%
  %\qquad
  \subfloat[]{\includegraphics[width=0.5\textwidth]{PRWs_analytical}}%
  \caption{Implementing LRWs and PRWs with $1338643$ particles. (a)
    and (b) illustrate that the short and long time asypototic
    behaviors of the estimated survival functions of particles'
    diffusing times in LRWs and PRWs are consistent with the
    analytical result.}
\end{figure}

\begin{table}[h!]
  \centering
  \begin{tabular}{l llp{1.5cm} p{0.5cm} llp{1.5cm}}
    \toprule
    & \multicolumn{3}{l}{Kolmogorov-Smirnov} && \multicolumn{3}{l}{Mann-Whitney} \\ \cmidrule{2-4}\cmidrule{6-8}
    & Statistic & & P-value && Statistic & & P-value \\ \cmidrule{2-4}\cmidrule{6-8} \midrule
    LRWs \& Analytical & 1994705.0 && 0.442364 && 0.005  && 0.999999 \\
    PRWs \& Analytical & 1950437.0 && 0.087366 && 0.018 && 0.902355 \\
    \bottomrule
  \end{tabular}
  \caption{}
\end{table}

As shown in Table $2.1$, the null hypothesis of the nonparametric Mann-Whitney U and
Kolmogorov–Smirnov tests can not be rejected since p-values are bigger
than $0.05$, which implies that the differences of survival probabilities of the
numerical simulation and analytical results are not statistically
significant.

\subsection{Conclusion}

